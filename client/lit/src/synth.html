<!DOCTYPE html>
<html>
  <head>
    <title>MIDI FREQ</title>
    <link rel="stylesheet" type="text/css" href="synth/styles.css" />
    <script src="../node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
    <script type="module" src="ws-component.js"></script>
  </head>

  <body>
    <ws-component></ws-component>

    <script type="module">
      import WsClient from '../../utils/WsClient.js';

      window.wsClient = new WsClient({
        handleMessage: (data) => {
          if (data.type === 'noteOut') {
            let [note, velocity] = data.data;
            if (velocity > 0) playSynth(note, velocity);
            else stopSynth(note);
          }
        },
      });

      document.querySelector('ws-component').ws = window.wsClient;
    </script>

    <div id="canvas"></div>

    <div id="device-select-container" style="display: none">
      <p>press shift+space to toggle controls</p>
      <label for="device-select">Select MIDI Device:</label>
      <select id="device-select"></select>
    </div>

    <script type="module" src="synth/audio.js"></script>
    <script type="module" src="synth/video.js"></script>
  </body>
</html>
